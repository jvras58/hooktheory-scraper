# Puppeteer - Hooktheory

## üìñ Sobre o Projeto
Este projeto √© um scraping que utiliza o site Hooktheory para varrer a base de dados com os artistas e suas m√∫sicas e inserir os dados em um banco de dados MongoDB.


## üöÄ Tecnologias e Ferramentas
O projeto foi criado em JavaScript (mas pode ser facilmente convertido para TypeScript) com o Puppeteer e utiliza um Dockerfile para simplificar o uso.

#### Bibliotecas e Tecnologias Utilizadas:
| Tecnologia           | Vers√£o    |
|----------------------|-----------|
| **Runtime**           |           |
| Node                  | v18.x     |
| **Desenvolvimento**   |           |
| Docker Engine         | vXX.X.X   |
| Bundler               | v2.6.0    |

### Organiza√ß√£o do Projeto

```
/
‚îú‚îÄüìÅ .devcontainer     -> Configura√ß√µes do ambiente de desenvolvimento (Devcontainer)
‚îú‚îÄüìÅ docs              -> Artefatos de documenta√ß√£o
‚îú‚îÄ‚îÄüìÅsrc
‚îÇ   ‚îú‚îÄüáØindex.js            -> Arquivo principal para iniciar o scraping
‚îÇ       ...
‚îÇ   ‚îú‚îÄüìÅscraping
‚îÇ      ‚îú‚îÄüáØxxxx.js       ->  Fun√ß√µes de scraping espec√≠ficas (e.g., pesquisa, login...)
‚îÇ       ...
‚îÇ   ‚îú‚îÄüìÅutils             
‚îÇ      ‚îú‚îÄüáØfileManager.js   -> Fun√ß√µes para salvar capturas de tela, dados, etc.
‚îÇ      ‚îú‚îÄüáØlogger.js        -> Logs e tratamento de erros
‚îÇ       ...
‚îú‚îÄ‚îÄüìÅ Config
‚îÇ   ‚îú‚îÄüáØbrowser.js          -> configura√ß√µes do navegador
‚îÇ   ‚îú‚îÄüáØconfig.js           -> configura√ß√µes do Puppeteer
‚îÇ   ‚îú‚îÄüáØdb.js               -> configura√ß√µes do mongoDB
‚îÇ       ...
‚îú‚îÄüìÅscreenshots             -> Pasta onde as capturas de tela ser√£o salvas
‚îú‚îÄ‚îÄ package.json            -> Configura√ß√µes e depend√™ncias do projeto
‚îú‚îÄüìÑ .gitignore             -> Arquivos e pastas ignorados pelo Git
‚îú‚îÄüìÑ Makefile               -> Automa√ß√£o de tarefas
‚îî‚îÄüìÑ README.md              -> Documenta√ß√£o do projeto (Este arquivo)
```

## üõ†Ô∏è Configura√ß√£o do Ambiente de Desenvolvimento

Este reposit√≥rio est√° configurado para rodar em um **Devcontainer** no VSCode. Siga os passos abaixo para instanciar o ambiente.

### Extens√µes Recomendadas

- **Nome**: Remote Development
- **Id**: `ms-vscode-remote.vscode-remote-extensionpack`
- **Descri√ß√£o**: Pacote de extens√µes que permite abrir pastas em containers, m√°quinas remotas ou WSL com todas as funcionalidades do VSCode.
- **Vers√£o**: 0.25.0
- [VSCode Marketplace Link](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack)

### Docker Engine

√â necess√°rio ter o Docker Engine instalado. Veja o guia de instala√ß√£o para seu sistema operacional [aqui](https://docs.docker.com/engine/install/).

### Procedimento para Instanciar o Projeto no VSCode

1. Instale o pacote de extens√µes recomendadas.
2. Clone ou fa√ßa fork deste reposit√≥rio.
3. Abra o diret√≥rio do projeto no VSCode.
4. Execute o comando _Dev Containers: Reopen in Container_ na paleta de comandos do VSCode (_F1, Ctrl+Shift+P_).

Ap√≥s a configura√ß√£o do Devcontainer, o VSCode abrir√° o projeto dentro de um ambiente isolado, conforme definido no diret√≥rio **/.devcontainer**.

## üöÄ Iniciando a Aplica√ß√£o

1. Para iniciar o scraping (instalar as depend√™ncias e configurar o ambiente):
    ```sh
    make scraping
    ```

### Gerenciamento de Depend√™ncias

1. Instale uma nova biblioteca:
    ```sh
    npm install <nome_da_lib>
    ```

## üìñ Caso Prefira sem o Devcontainer

Se voc√™ preferir configurar e executar o projeto sem usar o devcontainer, siga as instru√ß√µes abaixo:

### Pr√©-requisitos

- Node.js (vers√£o 18 ou superior)
- npm (vers√£o 6 ou superior)
- Docker (opcional, se desejar usar o Docker para executar o Puppeteer)


### Executando o scraping localmente 

1. **Inicie o MongoDB:**

    ```sh
    docker run -d \
      --name mongodb \
      -p 27017:27017 \
      -v ~/mongodb/data:/data/db \
      mongo:latest
    ```

2. **Configure o arquivo `.env`:**

    Abra o arquivo `.env` na raiz do projeto `MONGO_URI` para:

    ```env
    MONGO_URI=mongodb://localhost:27017
    ```

3. **Execute o scraping:**

    ```sh
    make scraping
    ```

4. **(Opcional) Execute o scraping usando Docker:**

    Se preferir usar Docker para isolar o ambiente de execu√ß√£o, voc√™ pode construir e executar o cont√™iner Docker:

    1. **Inicie os servi√ßos:**

        ```sh
        docker compose build
        ```

        *Para executar em modo destacado (background), use:*

        ```sh
        docker compose up -d
        ```

    2. **Verifique os logs dos servi√ßos:**

        ```sh
        docker compose logs -f
        ```

    3. **Parar os servi√ßos:**

        ```sh
        docker compose down
        ```

### üìñ Como Visualizar os Dados no MongoDB

1. **Conectar ao MongoDB via Docker Exec:**
    ```sh
    docker exec -it mongodb mongosh
    ```

2. **Conectar-se ao MongoDB:**
    ```sh
    mongosh mongodb://localhost:27017
    ```

3. **Selecionar o banco de dados desejado:**

    ```javascript
    use hooktheory-scraper
    ```

4. **Listar as cole√ß√µes dispon√≠veis:**
    ```javascript
    show collections
    ```

5. **Visualizar os documentos em uma cole√ß√£o espec√≠fica (exemplo: `artists`):**
    ```javascript
    db.artists.find().pretty()
    ```

## üìÑ Licen√ßa

Este projeto est√° licenciado sob uma licen√ßa de uso restrito. **N√£o √© permitida a utiliza√ß√£o deste c√≥digo para fins lucrativos**. O uso e a distribui√ß√£o s√£o permitidos somente para fins educacionais, pessoais e de pesquisa. Ao utilizar este reposit√≥rio, voc√™ concorda em n√£o utilizar este c√≥digo em projetos comerciais ou em qualquer outro contexto com fins de lucro.

Para mais informa√ß√µes sobre as permiss√µes e restri√ß√µes, consulte o arquivo `LICENSE.md`. [aqui](docs/LICENSE.md)

